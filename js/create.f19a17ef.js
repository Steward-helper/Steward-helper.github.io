(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["create"],{1276:function(t,e,r){"use strict";var n=r("d784"),a=r("44e7"),i=r("825a"),o=r("1d80"),s=r("4840"),c=r("8aa5"),u=r("50c4"),l=r("14c3"),f=r("9263"),d=r("d039"),p=[].push,v=Math.min,h=4294967295,m=!d((function(){return!RegExp(h,"y")}));n("split",2,(function(t,e,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,r){var n=String(o(this)),i=void 0===r?h:r>>>0;if(0===i)return[];if(void 0===t)return[n];if(!a(t))return e.call(n,t,i);var s,c,u,l=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,m=new RegExp(t.source,d+"g");while(s=f.call(m,n)){if(c=m.lastIndex,c>v&&(l.push(n.slice(v,s.index)),s.length>1&&s.index<n.length&&p.apply(l,s.slice(1)),u=s[0].length,v=c,l.length>=i))break;m.lastIndex===s.index&&m.lastIndex++}return v===n.length?!u&&m.test("")||l.push(""):l.push(n.slice(v)),l.length>i?l.slice(0,i):l}:"0".split(void 0,0).length?function(t,r){return void 0===t&&0===r?[]:e.call(this,t,r)}:e,[function(e,r){var a=o(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,a,r):n.call(String(a),e,r)},function(t,a){var o=r(n,t,this,a,n!==e);if(o.done)return o.value;var f=i(t),d=String(this),p=s(f,RegExp),g=f.unicode,b=(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.unicode?"u":"")+(m?"y":"g"),y=new p(m?f:"^(?:"+f.source+")",b),w=void 0===a?h:a>>>0;if(0===w)return[];if(0===d.length)return null===l(y,d)?[d]:[];var S=0,A=0,x=[];while(A<d.length){y.lastIndex=m?A:0;var $,E=l(y,m?d:d.slice(A));if(null===E||($=v(u(y.lastIndex+(m?0:A)),d.length))===S)A=c(d,A,g);else{if(x.push(d.slice(S,A)),x.length===w)return x;for(var _=1;_<=E.length-1;_++)if(x.push(E[_]),x.length===w)return x;A=S=$}}return x.push(d.slice(S)),x}]}),!m)},"25f0":function(t,e,r){"use strict";var n=r("6eeb"),a=r("825a"),i=r("d039"),o=r("ad6d"),s="toString",c=RegExp.prototype,u=c[s],l=i((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),f=u.name!=s;(l||f)&&n(RegExp.prototype,s,(function(){var t=a(this),e=String(t.source),r=t.flags,n=String(void 0===r&&t instanceof RegExp&&!("flags"in c)?o.call(t):r);return"/"+e+"/"+n}),{unsafe:!0})},"2c22":function(t,e,r){},"2ca0":function(t,e,r){"use strict";var n=r("23e7"),a=r("06cf").f,i=r("50c4"),o=r("5a34"),s=r("1d80"),c=r("ab13"),u=r("c430"),l="".startsWith,f=Math.min,d=c("startsWith"),p=!u&&!d&&!!function(){var t=a(String.prototype,"startsWith");return t&&!t.writable}();n({target:"String",proto:!0,forced:!p&&!d},{startsWith:function(t){var e=String(s(this));o(t);var r=i(f(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return l?l.call(e,n,r):e.slice(r,r+n.length)===n}})},3243:function(t,e,r){},"3ca3":function(t,e,r){"use strict";var n=r("6547").charAt,a=r("69f3"),i=r("7dd0"),o="String Iterator",s=a.set,c=a.getterFor(o);i(String,"String",(function(t){s(this,{type:o,string:String(t),index:0})}),(function(){var t,e=c(this),r=e.string,a=e.index;return a>=r.length?{value:void 0,done:!0}:(t=n(r,a),e.index+=t.length,{value:t,done:!1})}))},4478:function(t,e,r){"use strict";var n=r("2c22"),a=r.n(n);a.a},"44e7":function(t,e,r){var n=r("861d"),a=r("c6b6"),i=r("b622"),o=i("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==a(t))}},"4df4":function(t,e,r){"use strict";var n=r("0366"),a=r("7b0b"),i=r("9bdd"),o=r("e95a"),s=r("50c4"),c=r("8418"),u=r("35a1");t.exports=function(t){var e,r,l,f,d,p,v=a(t),h="function"==typeof this?this:Array,m=arguments.length,g=m>1?arguments[1]:void 0,b=void 0!==g,y=u(v),w=0;if(b&&(g=n(g,m>2?arguments[2]:void 0,2)),void 0==y||h==Array&&o(y))for(e=s(v.length),r=new h(e);e>w;w++)p=b?g(v[w],w):v[w],c(r,w,p);else for(f=y.call(v),d=f.next,r=new h;!(l=d.call(f)).done;w++)p=b?i(f,g,[l.value,w],!0):l.value,c(r,w,p);return r.length=w,r}},5319:function(t,e,r){"use strict";var n=r("d784"),a=r("825a"),i=r("7b0b"),o=r("50c4"),s=r("a691"),c=r("1d80"),u=r("8aa5"),l=r("14c3"),f=Math.max,d=Math.min,p=Math.floor,v=/\$([$&'`]|\d\d?|<[^>]*>)/g,h=/\$([$&'`]|\d\d?)/g,m=function(t){return void 0===t?t:String(t)};n("replace",2,(function(t,e,r,n){var g=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,b=n.REPLACE_KEEPS_$0,y=g?"$":"$0";return[function(r,n){var a=c(this),i=void 0==r?void 0:r[t];return void 0!==i?i.call(r,a,n):e.call(String(a),r,n)},function(t,n){if(!g&&b||"string"===typeof n&&-1===n.indexOf(y)){var i=r(e,t,this,n);if(i.done)return i.value}var c=a(t),p=String(this),v="function"===typeof n;v||(n=String(n));var h=c.global;if(h){var S=c.unicode;c.lastIndex=0}var A=[];while(1){var x=l(c,p);if(null===x)break;if(A.push(x),!h)break;var $=String(x[0]);""===$&&(c.lastIndex=u(p,o(c.lastIndex),S))}for(var E="",_=0,k=0;k<A.length;k++){x=A[k];for(var O=String(x[0]),j=f(d(s(x.index),p.length),0),C=[],I=1;I<x.length;I++)C.push(m(x[I]));var R=x.groups;if(v){var P=[O].concat(C,j,p);void 0!==R&&P.push(R);var T=String(n.apply(void 0,P))}else T=w(O,p,j,C,R,n);j>=_&&(E+=p.slice(_,j)+T,_=j+O.length)}return E+p.slice(_)}];function w(t,r,n,a,o,s){var c=n+t.length,u=a.length,l=h;return void 0!==o&&(o=i(o),l=v),e.call(s,l,(function(e,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return r.slice(0,n);case"'":return r.slice(c);case"<":s=o[i.slice(1,-1)];break;default:var l=+i;if(0===l)return e;if(l>u){var f=p(l/10);return 0===f?e:f<=u?void 0===a[f-1]?i.charAt(1):a[f-1]+i.charAt(1):e}s=a[l-1]}return void 0===s?"":s}))}}))},"5a34":function(t,e,r){var n=r("44e7");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},"9fe1":function(t,e,r){"use strict";var n=r("3243"),a=r.n(n);a.a},a15b:function(t,e,r){"use strict";var n=r("23e7"),a=r("44ad"),i=r("fc6a"),o=r("a640"),s=[].join,c=a!=Object,u=o("join",",");n({target:"Array",proto:!0,forced:c||!u},{join:function(t){return s.call(i(this),void 0===t?",":t)}})},a630:function(t,e,r){var n=r("23e7"),a=r("4df4"),i=r("1c7e"),o=!i((function(t){Array.from(t)}));n({target:"Array",stat:!0,forced:o},{from:a})},ab13:function(t,e,r){var n=r("b622"),a=n("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[a]=!1,"/./"[t](e)}catch(n){}}return!1}},d28b:function(t,e,r){var n=r("746f");n("iterator")},d81d:function(t,e,r){"use strict";var n=r("23e7"),a=r("b727").map,i=r("1dde"),o=r("ae40"),s=i("map"),c=o("map");n({target:"Array",proto:!0,forced:!s||!c},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},d879:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"page-create"},[r("div",{staticClass:"container"},[r("div",{staticClass:"form-panel"},[r("a-form-model",{ref:"form",attrs:{model:t.form,"label-col":{span:5},"wrapper-col":{span:10},rules:t.rules},on:{submit:t.handleSubmit}},[r("a-form-model-item",{attrs:{label:"Name",prop:"name"}},[r("a-input",{attrs:{placeholder:t.$t("enter.automation.name")},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),r("a-form-model-item",{attrs:{label:"Action",prop:"type"}},[r("a-select",{attrs:{dropdownMatchSelectWidth:!1,placeholder:t.$t("choose.automation.action")},on:{change:t.onActionChange},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.options.actions,(function(e){return r("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1),t.args.length?t._l(t.args,(function(e){return r("a-form-model-item",{key:e.name,attrs:{label:e.name}},[r("a-tooltip",[r("template",{slot:"title"},[t._v(" "+t._s(e.tips)+" ")]),"string"===e.type?r("a-input",{attrs:{placeholder:e.placeholder},model:{value:e.value,callback:function(r){t.$set(e,"value",r)},expression:"arg.value"}}):t._e(),"boolean"===e.type?r("a-switch",{model:{value:e.value,callback:function(r){t.$set(e,"value",r)},expression:"arg.value"}}):t._e()],2)],1)})):t._e(),r("a-form-model-item",{attrs:{label:"Target",prop:"target"}},[r("a-input",{attrs:{placeholder:t.$t("enter.automation.target.selector")},model:{value:t.form.target,callback:function(e){t.$set(t.form,"target",e)},expression:"form.target"}},[r("div",{attrs:{slot:"addonBefore"},slot:"addonBefore"},[t._v("@")])])],1),r("a-form-model-item",{attrs:{label:"Instructions","wrapper-col":{span:18}}},[r("code",{staticClass:"code"},[t._v(t._s(t.instructions))])]),r("a-form-model-item",{attrs:{label:"Pattern",prop:"pattern"}},[r("a-input",{attrs:{placeholder:t.$t("enter.automation.url.pattern")},model:{value:t.form.pattern,callback:function(e){t.$set(t.form,"pattern",e)},expression:"form.pattern"}})],1),r("a-form-model-item",{attrs:{label:"RunAt",prop:"runAt"}},[r("a-select",{attrs:{dropdownMatchSelectWidth:!1,placeholder:t.$t("choose.automation.runat")},model:{value:t.form.runAt,callback:function(e){t.$set(t.form,"runAt",e)},expression:"form.runAt"}},t._l(t.options.runAt,(function(e){return r("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1),r("a-form-model-item",{attrs:{label:"Video",prop:"video"}},[r("a-textarea",{attrs:{placeholder:t.$t("enter.automation.video"),autoSize:{minRows:2}},model:{value:t.form.video,callback:function(e){t.$set(t.form,"video",e)},expression:"form.video"}})],1),r("a-form-model-item",{attrs:{label:"Intro",prop:"intro","wrapper-col":{span:18}}},[r("a-icon",{class:{"is-active":t.inpreview},attrs:{type:"read"},on:{click:t.onPreviewClick}}),r("a-textarea",{directives:[{name:"show",rawName:"v-show",value:!t.inpreview,expression:"!inpreview"}],attrs:{placeholder:t.$t("enter.automation.intro"),autoSize:{minRows:2}},model:{value:t.form.intro,callback:function(e){t.$set(t.form,"intro",e)},expression:"form.intro"}}),t.inpreview?r("div",{staticClass:"intro-preview",domProps:{innerHTML:t._s(t.introPreview)}}):t._e()],1),r("a-form-model-item",{attrs:{"wrapper-col":{span:10,offset:5}}},[r("a-button",{attrs:{type:"primary","html-type":"submit",disabled:t.submitting}},[t._v(t._s(t.submitBtnText))])],1)],2)],1)])])},a=[],i=(r("99af"),r("4de4"),r("7db0"),r("4160"),r("a15b"),r("d81d"),r("fb6a"),r("b0c0"),r("ac1f"),r("5319"),r("1276"),r("159b"),r("bf19"),r("5530"));function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t){if(Array.isArray(t))return o(t)}r("a4d3"),r("e01a"),r("d28b"),r("a630"),r("e260"),r("d3b7"),r("3ca3"),r("ddb0");function c(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}r("25f0");function u(t,e){if(t){if("string"===typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(t){return s(t)||c(t)||u(t)||l()}function d(t){if(Array.isArray(t))return t}function p(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)if(r.push(o.value),e&&r.length===e)break}catch(c){a=!0,i=c}finally{try{n||null==s["return"]||s["return"]()}finally{if(a)throw i}}return r}}function v(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t,e){return d(t)||p(t,e)||u(t,e)||v()}function m(t){return d(t)||c(t)||u(t)||v()}var g=r("267e");r("2ca0");function b(){return JSON.parse(JSON.stringify(g["a"]))}function y(){return{name:"",intro:"",pattern:"",target:"body",type:"",runAt:1,video:""}}function w(t){return{name:[{required:!0,message:t.$t("enter.automation.name")}],type:[{required:!0,message:t.$t("choose.automation.action")}],target:[{required:!0,message:t.$t("enter.automation.target.selector")}],pattern:[{required:!0,message:t.$t("enter.automation.url.pattern")}],video:[{validator:function(e,r,n){r?r.startsWith("<iframe")?n():n(new Error(t.$t("invalid.video"))):n()}}]}}var S=r("b1c8"),A=r("1f57"),x=r("7eda"),$={name:"AutomationCreate",data:function(){var t=this.$route.params.id;return{id:t,mode:t?"update":"create",options:{actions:g["a"],runAt:g["c"]},actionConfigs:b(),form:y(),rules:w(this),args:[],inpreview:!1,submitting:!1,introPreview:""}},computed:{instructions:function(){var t=this.getFullAction(),e=this.form.target;return[t,"@",e].join("")},submitBtnText:function(){return"create"===this.mode?this.$t("create"):this.$t("update")}},methods:{isAuthor:function(t){var e=Object(A["a"])();return e.id===t.objectId},loadData:function(){var t=this;S["b"].item(this.id).then((function(e){var r=e.toJSON();t.isAuthor(r.author)?t.handleData(r):t.$message.warn(t.$t("permission.denied"),(function(){t.$router.replace("/")}))}))},handleData:function(t){var e=t.name,r=t.intro,n=t.pattern,a=t.type,i=t.video,o=t.instructions,s=t.runAt;Object.assign(this.form,{name:e,intro:r,pattern:n,type:a,video:i,runAt:s}),this.updateArgs(a);var c=this.parseInstructions(o),u=c.target,l=c.args;this.form.target=u,this.setArgs(l)},setArgs:function(t){this.args.forEach((function(e){Object.prototype.hasOwnProperty.call(t,e.name)&&(e.value=t[e.name])}))},getExecOptions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e={};return t.forEach((function(t){var r=t.split("!"),n=m(r),a=n[0],i=n.slice(1);i.length?1===i.length?e[a]="true"===i||"false"===i?"true"===i:i[0]:e[a]=i:e[a]=!0})),e},parseInstructions:function(t){var e=t.split("@"),r=h(e,2),n=r[0],a=r[1],i=n.split("^"),o=m(i),s=o[0],c=o.slice(1);return{action:s,args:this.getExecOptions(c),target:a}},getFullAction:function(){var t=this.form.type,e=this.args;if(this.args.length){var r=e.filter((function(t){return t.value!==t.defaultValue})).map((function(t){return[t.name,t.value].join("!")}));return[t].concat(f(r)).join("^")}return t},reset:function(){this.form=y(),this.actionConfigs=b(),this.args=[]},create:function(t){var e=this;return Object(S["a"])(t).then((function(){e.submitting=!1,e.$message.success(e.$t("create.ok")),e.reset()})).catch((function(){e.$message.error(e.$t("create.error"))}))},update:function(t){var e=this;return S["b"].updateOne(this.id,t).then((function(){e.submitting=!1,e.$message.success(e.$t("update.ok"))})).catch((function(){e.$message.error(e.$t("update.error"))}))},submit:function(){var t=Object.assign({},this.form);delete t.target;var e=Object(i["a"])(Object(i["a"])({},t),{},{instructions:this.instructions});this.submitting=!0,"create"===this.mode?this.create(e):this.update(e)},handleSubmit:function(t){var e=this;t.preventDefault(),this.$refs.form.validate((function(t){t&&e.submit()}))},updateArgs:function(t){var e=this.actionConfigs.find((function(e){return e.value===t}));this.args=e&&e.args||[]},onActionChange:function(t){this.updateArgs(t)},onPreviewClick:function(){this.inpreview=!this.inpreview,this.inpreview&&(this.introPreview=Object(x["a"])(this.form.intro))}},mounted:function(){"update"===this.mode&&this.loadData()}},E=$,_=(r("4478"),r("9fe1"),r("2877")),k=Object(_["a"])(E,n,a,!1,null,"78b0bdbf",null);e["default"]=k.exports},e01a:function(t,e,r){"use strict";var n=r("23e7"),a=r("83ab"),i=r("da84"),o=r("5135"),s=r("861d"),c=r("9bf2").f,u=r("e893"),l=i.Symbol;if(a&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var f={},d=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof d?new l(t):void 0===t?l():l(t);return""===t&&(f[e]=!0),e};u(d,l);var p=d.prototype=l.prototype;p.constructor=d;var v=p.toString,h="Symbol(test)"==String(l("test")),m=/^Symbol\((.*)\)[^)]+$/;c(p,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,e=v.call(t);if(o(f,t))return"";var r=h?e.slice(7,-1):e.replace(m,"$1");return""===r?void 0:r}}),n({global:!0,forced:!0},{Symbol:d})}},fb6a:function(t,e,r){"use strict";var n=r("23e7"),a=r("861d"),i=r("e8b5"),o=r("23cb"),s=r("50c4"),c=r("fc6a"),u=r("8418"),l=r("b622"),f=r("1dde"),d=r("ae40"),p=f("slice"),v=d("slice",{ACCESSORS:!0,0:0,1:2}),h=l("species"),m=[].slice,g=Math.max;n({target:"Array",proto:!0,forced:!p||!v},{slice:function(t,e){var r,n,l,f=c(this),d=s(f.length),p=o(t,d),v=o(void 0===e?d:e,d);if(i(f)&&(r=f.constructor,"function"!=typeof r||r!==Array&&!i(r.prototype)?a(r)&&(r=r[h],null===r&&(r=void 0)):r=void 0,r===Array||void 0===r))return m.call(f,p,v);for(n=new(void 0===r?Array:r)(g(v-p,0)),l=0;p<v;p++,l++)p in f&&u(n,l,f[p]);return n.length=l,n}})}}]);
//# sourceMappingURL=create.f19a17ef.js.map